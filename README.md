# EVE Looter

> ⚠️ **DISCLAIMER: AI GENERATED CODE**
>
> This project, including all source code, logic, and documentation, was generated by an
> Artificial Intelligence model. While efforts have been made to ensure functionality and
> safety, it should be reviewed before use in production environments. Use at your own risk.

**EVE Looter** is a self-contained web tool written in Rust that automates the calculation of 
fleet loot payouts. It parses kill data from ZKillboard, resolves character details via ESI, 
and calculates individual shares based on participation, allowing for complex Alt-to-Main mapping.

## Features
- ZKillboard Integration: Fetches killmails for specific systems, corporations, or alliances.
- Smart Pagination: Automatically paginates through ZKillboard history until it finds kills matching your specific date range.
- ESI Hydration: Enriches ZKillboard summary data with detailed information (participants, ship types, exact times) directly from the EVE Swagger Interface (ESI).
- Alt Mapping: Map multiple alt characters to a single "Main" character to ensure payouts are aggregated correctly.
- Dynamic Exclusion:
  - Exclude Kills: Uncheck specific kills to remove them from the total pot (e.g., friendly fire, wrong fleet).
  - Exclude Pilots: Uncheck specific beneficiaries to remove them from the payout calculation.
- Capitalist Payout Logic: Loot is split per-kill among only the pilots present on that specific kill.
- Caching: In-memory caching of ESI responses and Name Resolution to minimize API calls and avoid rate limits.
- Resilient Networking: Handles ESI rate limits (420/429 errors) and standardizes backoffs.
- Single Binary: The web server and HTML templates are compiled into a single executable for easy distribution.

## Usage Guide
1. Configuration:
    - ZKillboard Link: Paste the URL of the entity you want to track (e.g., https://zkillboard.com/system/30000142/ or https://zkillboard.com/corporation/98654321/).
    - Date Range: Select the Start and End dates. The tool enforces a maximum window of 30 days to protect API limits.
    - Alt Mapping: Enter mappings one per line in the format Alt Name = Main Name.
    - Example:
      ```
      Cynocal = Main Character
      Logi Alt 5 = Main Character
      ```

2. Processing:
    - Click Fetch & Calculate.
    - The tool will fetch the summary list from ZKillboard and then hydrate details from ESI.

3. Refining Results:
    - Kill Log: Uncheck boxes next to specific kills to exclude them.
    - Beneficiaries: Uncheck boxes next to character names to exclude them from the payout.
    - The totals and shares recalculate immediately upon changing any checkbox.

## Installation & Running

### Option A: Running from Source

1. Clone the repository.
1. Build and run using Cargo:

```
cargo run --release
```

3. Access the tool in your browser at http://localhost:3000.

### Option B: Docker

This project includes a multi-stage Dockerfile optimized for size (Alpine Linux).

1. Build the image:
```
docker build -t eve-looter .
```

2. Run the container:
```
docker run -p 3000:3000 --name eve-looter eve-looter
```

3. Access the tool at http://localhost:3000.
